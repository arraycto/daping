(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24ad7c7a"],{"185a":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("my-draggable",{attrs:{width:t.compConf.box.width,height:t.compConf.box.height,left:t.compConf.box.left,top:t.compConf.box.top,index:t.compConf.compId,compConf:t.compConf,boxStyle:t.boxStyle},on:{focus:t.handleFocus,blur:t.handleBlur,compMove:t.compMove,compRotate:t.compRotate}},[o(t.compConf.componentName,{ref:"contentComp",tag:"component",style:{transform:"rotate("+t.compConf.box.rotate+"deg)"},attrs:{compConf:t.compConf,mainId:t.compConf.compId,id:t.compConf.compId},on:{compState:t.compStateChanged}})],1)},i=[],a=(o("c726"),o("6540"),o("fae2"),o("d211")),s=o("0e0b"),c=o("cf6b"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:["my-draggable",{"my-draggable--active":t.compConf.isActive||t.overActive,"my-draggable--move":t.moveActive}],style:t.styleName,on:{mousedown:function(e){return e.stopPropagation(),t.handleMove(e)},mouseover:function(e){return e.stopPropagation(),t.handleOver(e)},mouseout:function(e){return e.stopPropagation(),t.handleOut(e)},contextmenu:function(e){return e.stopPropagation(),e.preventDefault(),t.contain.handleContextMenu(e,t.compConf)},click:function(t){t.stopPropagation()}}},[o("div",{ref:"my-draggable-wrapper",staticClass:"my-draggable__wrapper"},[t.overActive||t.compConf.isActive?[o("div",{staticClass:"my-draggable__line my-draggable__line--left",style:t.styleLineName}),o("div",{staticClass:"my-draggable__line my-draggable__line--top",style:t.styleLineName}),o("div",{staticClass:"my-draggable__line my-draggable__line--label"},[t._v(t._s(t.baseLeft)+","+t._s(t.baseTop))])]:t._e(),t._l(t.rangeList,(function(e,n){return[t.compConf.isActive?o("div",{key:n,class:["my-draggable__range","my-draggable__range--"+e.classname],style:[t.styleRangeName,t.getRangeStyle(e.classname)],on:{mousedown:function(o){return o.stopPropagation(),t.rangeMove(o,e.classname)}}}):t._e()]})),t.compConf.isActive?o("div",{staticClass:"my-draggable__operate"},[o("el-tooltip",{staticClass:"my-tooltip",attrs:{content:"删除",placement:"top"}},[o("el-button",{attrs:{icon:"el-icon-close",type:"primary"},on:{click:function(e){return t.contain.delComs()}},nativeOn:{mousedown:function(t){t.stopPropagation()}}})],1),o("el-tooltip",{staticClass:"my-tooltip",attrs:{content:"移动图表",placement:"top",manual:!0}},[o("el-button",{attrs:{icon:"el-icon-rank",type:"primary"},nativeOn:{mousedown:function(e){return e.stopPropagation(),t.handleMove(e)}}})],1),o("el-tooltip",{staticClass:"my-tooltip",attrs:{content:"旋转图表",placement:"top"}},[o("el-button",{staticStyle:{cursor:"move"},attrs:{icon:"el-icon-refresh",type:"primary"},nativeOn:{mousedown:function(e){return e.stopPropagation(),t.rotateComp(e)}}})],1)],1):t._e(),o("div",{directives:[{name:"show",rawName:"v-show",value:t.active||t.overActive,expression:"active || overActive"}],class:t.b("menu"),style:t.styleMenuName},[t._t("menu",null,{zIndex:t.zIndex,index:t.index})],2),o("div",{ref:"item",class:t.b("item")},[t._t("default")],2)],2)])},l=[],h=(o("72b3"),o("a866"),o("d0bf"),o("0bd5"),o("79a8"),o("270f"),"__"),p="--",m=function(t,e,o){return e?t+o+e:t},u=function t(e,o){if("string"===typeof o)return m(e,o,p);if(Array.isArray(o))return o.map((function(o){return t(e,o)}));var n={};return Object.keys(o||{}).forEach((function(t){n[e+p+t]=o[t]})),n},f={inject:["contain"],name:"my-draggable",props:{index:{type:[String,Number]},compConf:{type:[Object,Array]},mask:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},resize:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},zIndex:{type:[Number,String],default:1},left:{type:Number,default:0},top:{type:Number,default:0},width:{type:Number},height:{type:Number},boxStyle:{type:Object}},data:function(){return{baseWidth:0,baseHeight:0,baseLeft:0,baseTop:0,children:{},moveActive:!1,overActive:!1,rangeActive:!1,active:!1,keydown:null,translateX:0,translateY:0,step:1,rangeList:[{classname:"left"},{classname:"right"},{classname:"top"},{classname:"bottom"},{classname:"top-left"},{classname:"top-right"},{classname:"bottom-left"},{classname:"bottom-right"}]}},created:function(){this.init()},computed:{styleMenuName:function(){return{transformOrigin:"0 0",transform:"scale(".concat(this.scale,")")}},styleLineName:function(){return{borderWidth:1/this.scale+"px"}},styleItem:function(){return{width:this.baseWidth+"px",height:this.baseHeight+"px"}},styleRangeName:function(){var t=10/this.scale;return{width:t+"px",height:t+"px"}},styleLabelName:function(){return{fontSize:18/this.scale+"px"}},scale:function(){return this.$store.getters.getZoom()},styleName:function(){var t={zIndex:this.compConf.isActive?9999:this.compConf.compIndex,top:this.baseTop+"px",left:this.baseLeft+"px",width:this.baseWidth+"px",height:this.baseHeight+"px",transform:"translate("+this.translateX+"px,"+this.translateY+"px) scale(1,1)"};return t}},watch:{active:function(t){},width:function(t){this.$parent.isReload=!0,this.baseWidth=Object(s["b"])(t)||this.children.offsetWidth},height:function(t){this.$parent.isReload=!0,this.baseHeight=Object(s["b"])(t)||this.children.offsetHeight},left:function(t){this.$parent.isReload=!0,this.baseLeft=Object(s["b"])(t)},top:function(t){this.$parent.isReload=!0,this.baseTop=Object(s["b"])(t)},compData:{handler:function(t,e){this.compConf=t},deep:!0}},mounted:function(){},methods:{rotateComp:function(t){this.$emit("compRotate",t)},b:function(t,e){var o="my-draggable";return t&&"string"!==typeof t&&(e=t,t=""),t=m(o,t,h),e?[t,u(t,e)]:t},init:function(){this.baseWidth=Object(s["b"])(this.width),this.baseHeight=Object(s["b"])(this.height),this.baseLeft=Object(s["b"])(this.left),this.baseTop=Object(s["b"])(this.top)},setLeft:function(t){this.baseLeft=t},setTop:function(t){this.baseTop=t},getRangeStyle:function(t){var e=10/this.scale/2,o={},n=t.split("-");return n.forEach((function(t){o[t]=Object(s["c"])(-e)})),o},setOverActive:function(t){this.overActive=t},setActive:function(t){this.active=t},rangeMove:function(t,e){var o,n,i,a,c,r,l=this;this.rangeActive=!0,this.handleMouseDown(t);var h=t.clientX,p=t.clientY;document.onmousemove=function(t){l.moveActive=!0,"right"===e?(o=!0,n=!1):"left"===e?(o=!0,i=!0,c=!0,n=!1):"top"===e?(o=!1,n=!0,a=!0,r=!0):"bottom"===e?(o=!1,n=!0):"bottom-right"===e?(o=!0,n=!0):"bottom-left"===e?(o=!0,n=!0,i=!0,c=!0):"top-right"===e?(o=!0,n=!0,a=!0,r=!0):"top-left"===e&&(o=!0,n=!0,i=!0,c=!0,a=!0,r=!0);var m=t.clientX-h,u=t.clientY-p;if(h=t.clientX,p=t.clientY,o){var f=m*l.step/l.scale;c&&(f=-f),i&&(l.baseLeft=Object(s["b"])(l.baseLeft-f)),l.baseWidth=Object(s["b"])(l.baseWidth+f)}if(n){var d=u*l.step/l.scale;r&&(d=-d),a&&(l.baseTop=Object(s["b"])(l.baseTop-d)),l.baseHeight=Object(s["b"])(l.baseHeight+d)}},this.handleClear()},handleOut:function(){this.overActive=!1},handleOver:function(){this.overActive=!0},handleMove:function(t){var e=this;this.active=!0,this.handleMouseDown(t);var o=t.clientX,n=t.clientY;document.onmousemove=function(t){var i=t.clientX-o,a=t.clientY-n;o=t.clientX,n=t.clientY,e.baseLeft=Object(s["b"])(e.baseLeft+i*e.step/e.scale),e.baseTop=Object(s["b"])(e.baseTop+a*e.step/e.scale),"component"===e.compConf.compType&&e.$emit("compMove",{width:e.baseWidth,height:e.baseHeight,left:e.baseLeft,top:e.baseTop})},this.handleClear()},handleClear:function(){var t=this;document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,t.handleMouseUp()}},handleKeydown:function(){},handleMouseDown:function(t){this.moveActive=!0,this.$emit("focus",{index:this.index,width:this.baseWidth,height:this.baseHeight,left:this.baseLeft,top:this.baseTop,event:t})},handleMouseUp:function(){this.moveActive=!1,this.rangeActive=!1,this.$emit("blur",{index:this.index,width:this.baseWidth,height:this.baseHeight,left:this.baseLeft,top:this.baseTop})}}},d=f,b=(o("c285"),o("5d22")),g=Object(b["a"])(d,r,l,!1,null,null,null),v=g.exports,y=!1,C={inject:["contain"],provide:function(){return{contain:this.contain}},name:"Container",data:function(){return{myChart:null,isCtrl:!1,translateX:0,translateY:0,scaleW:1,scaleH:1,isReload:!1,compState:null,cx:0,cy:0}},components:{myDraggable:v},mixins:[],props:["compConf"],computed:Object(a["a"])(Object(a["a"])(Object(a["a"])({},Object(c["c"])({activeComp:"getFirstActiveComp"})),Object(c["d"])(["components"])),{},{compMap:function(){var t=this.components.compMap;return t},linkageData:function(){return this.$store.getters.getLinkagesByCompId(this.id)},id:function(){return this.compConf.compId},contentId:function(){return this.id+"-box"},boxStyle:function(){var t=this.compConf,e={};return t?(t.box.top&&(e.top=t.box.top+"px"),t.box.left&&(e.left=t.box.left+"px"),t.box.height&&(e.height=t.box.height+"px"),t.box.width&&(e.width=t.box.width+"px"),e.zIndex=this.compConf.compIndex,e.transform="translate("+this.translateX+"px,"+this.translateY+"px) scale("+this.scaleW+","+this.scaleH+")",e):e},isHighlight:function(){var t=this.compConf;return t.isHighlight&&!this.$store.getters.getPreviewState}}),updated:function(){this.isReload&&(this.$refs.contentComp&&this.$refs.contentComp.resize&&this.$refs.contentComp.resize(),this.isReload=!1)},methods:Object(a["a"])(Object(a["a"])({},Object(c["b"])(["switchComListDisplayState","moveTop","moveUp","moveDown","moveBottom","cleanAllActiveChild","delComs","selectOnlyOne","selectComs","highLightCom","cancelHighLightCom","changeHighlightLayer","cancelHighLightLayerCom","cleanAllHighLayer","onMoveToContainer"])),{},{handleFocus:function(t){t.index;var e=t.event;this.$store.commit("cleanAllHighLayer"),e.ctrlKey?(this.$store.commit("cleanAllActiveChild"),this.selectComs({compId:this.id,value:this.compConf.isActive})):(this._onHighLightLayer(),this.selectOnlyOne(this.id)),this.$store.commit("setScreenGridShow",!0)},_onHighLightLayer:function(){if("compContainer"!==this.compConf.componentName){var t=this.compMap;for(var e in t)"compContainer"===t[e]["componentName"]&&this.$store.commit("changeHighlightLayer",{compId:e,value:!0})}},handleBlur:function(t){var e=t.left,o=t.top,n=t.width,i=t.height,a={compId:this.id,left:e,top:o,width:n,height:i};if(this.$store.commit("updateCompStyle",a),this.isReload=!0,this.$store.commit("setScreenGridShow",!1),"component"===this.compConf.compType){var c=this.compMap;for(var r in c)if(["compContainer","containerDrill"].includes(c[r]["componentName"])){var l=Object(s["b"])(c[r].box.width),h=Object(s["b"])(c[r].box.height),p=Object(s["b"])(c[r].box.top),m=Object(s["b"])(c[r].box.left);e>=m&&e+n<=m+l&&o>=p&&o+i<=p+h&&this.onMoveToContainer({compId:this.id,containerId:r})}}},updateComp:function(t){t&&t.compId==this.compConf.compId&&(t.translateX&&(this.translateX=t.translateX),t.translateY&&(this.translateY=t.translateY),t.scaleH&&(this.scaleH=t.scaleH),t.scaleW&&(this.scaleW=t.scaleW))},changeScaleStyle:function(){var t=this;this.activeComp.property&&Object.keys(this.activeComp.property).map((function(e,o){t.activeComp.property[e].map((function(o,n){var i=["style"],a=0;"base"==e?(i.push(o),a=Math.ceil(t.scaleW*t.activeComp.style[o])):(i.push(e,o),a=Math.ceil(t.scaleW*t.activeComp.style[e][o])),t.$store.commit("modifyValueBySelected",{attrs:i,value:a})}))}))},clickComp:function(){this.$store.getters.getPreviewState||(this.isCtrl||this.$store.commit("cleanAllActive"),this.$store.commit("changeActive",{compId:this.id,value:!0}),this.isCtrl=!1)},reloadComp:function(t){t&&t.compId==this.compConf.compId&&(this.translateX=0,this.translateY=0,this.scaleW=1,this.scaleH=1,this.isReload=!0)},compStateChanged:function(t){y&&console.log("AbstractComp","[",this.id,"]","state change from:",this.compState," to ",t),this.compState=t},updateCompData:function(t){var e=this.$refs.contentComp;e.updateCompData||console.error("the component [",this.id,"] is not exist."),e.updateCompData(t)},compMove:function(t){},compRotate:function(t){var e=this,o=this.$refs.contentComp.$el,n=o.getBoundingClientRect(),i=n.width,a=n.height,c=n.left,r=n.top;this.cx=c+i/2,this.cy=r+a/2;var l=this.getCurrentAngle(t),h=this.compMap[this.id],p=h.box,m=p.rotate||0,u=m;document.onmousemove=function(t){var n=e.getCurrentAngle(t),i=n-l;u=(m+i)%360,u=Object(s["b"])(u),o.style.transform="rotate("+u+"deg)"},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,e.$store.commit("updateCompStyle",{compId:e.id,rotate:u})}},getCurrentAngle:function(t){var e=t.clientX,o=t.clientY,n=e-this.cx,i=o-this.cy,a=Math.abs(n/i),s=Math.atan(a)/(2*Math.PI)*360;return n<0&&i<0?s=360-s:n<0&&i>0?s=180+s:n>0&&i<0?s=s:n>0&&i>0&&(s=180-s),s}})},x=C,O=(o("54b8"),Object(b["a"])(x,n,i,!1,null,"8dfe6d44",null));e["a"]=O.exports},"54b8":function(t,e,o){"use strict";o("c424")},"98f2":function(t,e,o){var n=o("1f17"),i=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(o){try{return e[i]=!1,"/./"[t](e)}catch(n){}}return!1}},"9b3a":function(t,e,o){},b203:function(t,e,o){var n=o("00a5");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},b784:function(t,e,o){"use strict";var n=o("a09b"),i=o("b203"),a=o("4340"),s=o("98f2");n({target:"String",proto:!0,forced:!s("includes")},{includes:function(t){return!!~String(a(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},c285:function(t,e,o){"use strict";o("9b3a")},c424:function(t,e,o){}}]);